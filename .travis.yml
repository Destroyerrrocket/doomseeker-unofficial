language: cpp
sudo: required
dist: trusty

compiler:
- gcc

os:
- linux
- osx

addons:
  apt:
    packages:
      - g++
      - make
      - cmake
      - zlib1g-dev
      - libbz2-dev
      - qttools5-dev
      - qttools5-dev-tools
      - qtmultimedia5-dev
      - libqt4-dev

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update          ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install make qt5 zlib bzip2; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew link qt5 --force; fi

script:
- mkdir -p build
- cd build
- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then cmake -DCMAKE_PREFIX_PATH=/usr/local/Cellar/qt/5.11.2 .. fi
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then cmake .. fi
- make -j$(nproc)

after_success:
- make install